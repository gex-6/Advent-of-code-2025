// https://adventofcode.com/2025/day/4

const directions = [
    [-1, -1], // top left 
    [-1, 0], // up
    [-1, 1], // top right
    [0, -1], // left
    [0, 1], // right
    [1, -1], // bottom left
    [1, 0], // down
    [1, 1] // bottom right
];

// lvl 1

function findAcessRolls(input) {
    const paperRolls = input.split('\n').map(line => line.split(''));
    const rows = paperRolls.length;
    const cols = paperRolls[0].length;
    let amountOfAcessRolls = 0;
 
    for (let i = 0; i < rows; i++) {
        for (let j = 0; j < cols; j++) {
            const currentCell = paperRolls[i][j];
            const neighbors = [];
            
            // neighbours
            for (const [di, dj] of directions) {
                const ni = i + di;
                const nj = j + dj;
                
                // bounds check
                if (ni >= 0 && ni < rows && nj >= 0 && nj < cols) {
                    neighbors.push({
                        value: paperRolls[ni][nj],
                    });
                }
            }
            
            let amountOfAdjRolls = 0;
            if (currentCell === '@') {
                for (const neighbor of neighbors) {
                    if (neighbor.value === '@') {
                        amountOfAdjRolls++;
                    }
                }
                if (amountOfAdjRolls < 4) {
                    amountOfAcessRolls++;
                }
            } else {
                continue;
            }
        }
    }
    console.log("Total acces rolls: " + amountOfAcessRolls);
}

// lvl 2

function findAcessRolls2(input) {
    const paperRolls = input.split('\n').map(line => line.split(''));
    const rows = paperRolls.length;
    const cols = paperRolls[0].length;

    const amountOfAcessRolls = findAcessRollsRecursively(paperRolls, 0, 0, rows, cols);

    console.log("Total acces rolls: " + amountOfAcessRolls);
}

function findAcessRollsRecursively(paperRolls, amountOfAcessRolls, amountOfAcessRollsLast, rows, cols) {

    const countBeforeIteration = amountOfAcessRolls;

    for (let i = 0; i < rows; i++) {
        for (let j = 0; j < cols; j++) {
            const currentCell = paperRolls[i][j];
            const neighbors = [];
            
            // neighbours
            for (const [di, dj] of directions) {
                const ni = i + di;
                const nj = j + dj;
                
                // bounds check
                if (ni >= 0 && ni < rows && nj >= 0 && nj < cols) {
                    neighbors.push({
                        value: paperRolls[ni][nj],
                    });
                }
            }
            
            let amountOfAdjRolls = 0;
            if (currentCell === '@') {
                for (const neighbor of neighbors) {
                    if (neighbor.value === '@') {
                        amountOfAdjRolls++;
                    }
                }
                if (amountOfAdjRolls < 4) {
                    amountOfAcessRolls++;
                    paperRolls[i][j] = '.';
                }
            } else {
                continue;
            }
        }
    }

    // basic condition to stop the recursion
    if (amountOfAcessRolls === countBeforeIteration) {
        return amountOfAcessRolls;
    }

    return findAcessRollsRecursively(paperRolls, amountOfAcessRolls, countBeforeIteration, rows, cols);
}

const inputExample = `..@@.@@@@.
@@@.@.@.@@
@@@@@.@.@@
@.@@@@..@.
@@.@@@@.@@
.@@@@@@@.@
.@.@.@.@@@
@.@@@.@@@@
.@@@@@@@@.
@.@.@@@.@.`;

const input = `@@@@@@.@@..@@.@.@@.@@...@@.@@@.@.@.@.@@.@@@@@@@@@@@@.@.@@.@.@...@.@@@@@@@@..@@..@@@..@@@.@@@@..@.....@@@.@@.@@@@@@.@@.@@.@.@@@@@@.@@.@@.@
..@@.@@@@.@.@.@.@.@@..@@.@@@@@@.@@@..@@.@@.@.@.@.@.....@@..@.@@@@...@@@.@.@@.@..@.@@@@@..@..@@@@.@@@@.@@@@@@@@@@@@@@.@@..@.@.@..@.@@@@@@@
@.@.@@@@@@@@@@@@..@@@.@...@@.@..@.@@@.@..@@@.@@@.@@@@..@@@@.@@@@@.@@@@.@@@@@..@@@@@@@@.@@@@@@@@.@@@@.@.@.@..@@..@@@..@..@.@@@@.@.@..@@..@
@@@@@@@@@@...@@@.@@.@@@.@@@@.@..@@@..@@@@@.@.@@..@.@..@@@@..@.@@..@.@@..@@@@@@@@..@@@@@@.@@.@@@.@.@.@....@@@@.@.....@.@..@@@@@..@.@@..@.@
.@@@@@@@...@@.@@@@.@@.@@.@@@@@.@..@@@.@@.@@@..@.@@.@@..@@.@@@@@@.@@@@@@@@@..@@@.@@@..@@@..@..@@@@.@@@.@@@.@@@.@@..@@@@.@@@..@.@...@@..@@@
.@......@@@@.@.@.@@..@...@@@@.@@..@@@..@.@.@@@@.@..@@.@.@.@@@@@....@@.@@.@..@@@.@.@....@@..@@@@@@@@......@@@@@@.@@.@.@.@@..@.@.@@@@@@@@@@
@.@..@@@@.@@.@@@@@@.@@@.@@@@@.@.@@@@@.@@@@.@@@@@@@@.@.@@@..@@@.@@@@@@.@@@.@.@@.@...@.@@.....@.@...@@@.@.@@@.@@.@@..@@@@...@@.@@.@@.@..@@@
@..@@@@@@@@..@@@@@@.@@@@@.@.@@@@@@.@@..@@@@.@@@@...@@..@@.@.@@@@.@..@@@@.@.@@@...@@@..@@@.@.@....@.@@.@@.@@@..@@@@@@@.@@.@@..@@..@.@@.@@.
..@@.@@@@@@@@@@@@@...@.@@@@@.@@.@@@@...@@@@@@..@@@.@@...@.@.@@@.@.@@@.@@@@@.@@.....@@.@@@@@@.@@@@@@.@@@.@@..@@@@@@@.@..@@@@@@@.@@@.@@@@@.
@.@@@..@@@@@@@@@@@@@@.@@.@.@@.@@@@@@@@@@@@.@.@@@.@@@.@@.@@@@..@.@@@@@@@@@@@@@@.@.....@..@.@@@@@@.@..@.@@....@@..@.@@....@@@@@@.@.@@@@....
@@.@@.@@.@@@.@@@@@@.@@.@.@@@@@@.@....@@@.@.@.@.@@.@@.@@...@.@.@..@.@..@@@.@.@@.@@@@@@..@@@@@@.@.@....@@@..@@..@.@@.@.@@.@.@@@@@.@.@.@@..@
@@@@@@@@.@@@@@@@@@.@@@@@@..@.@@.@@.@@@...@.@.@@@.@@@@@@@@.@@@@..@.@.@@@@@.@@@.@@@@@@.@@@@.@.@@@@@@.@@..@...@@..@@@......@@..@..@@.@@@@@..
.@@@@.@@@@.@@.@@.@.@@@@...@@@..@@@.@..@@@@.@@.@@@@@@@@..@@@..@@.@@@@@.@@..@@..@.@@@...@@..@.@@@@@...@..@@....@.@.@@@@.@@@.@....@@.@@.@@@@
@@.@.@.@@@@@@@@@@@.@@@@@.....@..@@.@@@.@@..@.@.@.@@@..@@..@@@@@@@@@@@@@@.@@..@.@.@@@..@@@@@@@@@@......@.@@@@..@@@.@@@.@@@.@.@@@@@@@@@@@..
@@@@@@.@..@.@@@.@@@@@@@@@..@..@..@@@@@...@.@@@.@@@@..@@@...@@.@@@..@.@.@@..@.@@.@@@.@@@@.@@.@@@@@@@@..@@@@@.@@@.@@@@@@@@@@....@@@@@.@.@.@
@@@@@@.@@.@@@.@@@@.@@@.@.@.@.@@@@.@.@@.@.@@@@...@@@..@@@@.@@..@@..@@.@@.@@.@@@@..@@.@.@.@.@.@@@@@@.@.@.@@.@.@.@@@....@@.@@@@..@.@@..@@@@@
@@@@.@.@.@@@@.@.@@@.@@@.@..@.@@..@...@..@....@@..@@@...@@@@..@.@...@@@..@@@@@@@@..@..@.@@.@@@@@@@.@@@.@.@@@.@.@@.@@@@@.@@.@.@.@@.@@.@@.@@
.@...@@@@.@.@@@@.@@.@..@@@@.@@@.@@@.@.@.@@@@.@.@.@.@.@@@.@@@.@@@@@..@.@.@@@@@..@@.@@@@@.@..@..@.@@@@..@@@.@@@.....@@@@@@@.@@@@@@@@..@..@@
@@..@@@@.@@..@@.@@.@..@.@@.@@@@.@@@@@.@@@@..@@..@@.@.@@..@.@@@.@@@@.@.@.@@@@.@..@..@@@@...@.@@@.@@@.@@.@@@.@@@@@@.....@@@...@@..@@.@..@@@
@.@@@..@@.@@@@@@@@@@..@@@@@@@.@..@@@@@..@@@@.@@@.@@..@.@@.@...@.@@@@.@.@.@@@@..@..@..@.@@..@.@@.@@..@@@@@@@@.@@.@@@@@...@.@@@@@.@..@..@..
@@@..@@@@@.@..@@..@@..@@@.@@..@...@..@@@@@@@@@@..@@@@@@..@.@.@@@@@...@@@@@@@@.@.@.@@@.@@.@@@@@@.@..@..@..@@@@..@@@@.@@..@...@@@.@..@@.@@.
.@@@.@.@@.@@.@.@...@@..@@@@@...@@@...@@@@.@@@@.@@@@@@@@.@@@@@.@@@..@@@@@..@....@.@@@@@@@@..@@@@@@@.@@.@.@.@@.@@@.@.@.@@@@.@....@@.@@@@.@.
@@@@@@@.@.@.@@.@.@@.@@.@@@.@@@@..@@@@@@@@@@@@.@@@@....@@..@@@..@@@@@@.@.@@@.@..@..@@.@@@.@@..@......@@@@.@.@@.@@...@@....@@.@@@@@@@.@@@@@
@@.@@...@@..@@.@@@.@@@@@.@@...@@..@@...@@@.@@..@.@.@.@@.@.@.@@@@@@@.@@..@...@.@@@@@...@@@.@@@.@@.@..@@.@@@..@..@@@..@.@@.@@@@@.@..@@@@@@@
.@@@.@@....@@@.@@.@@...@.@.@@@@@@@...@.@.@@@@@.@.@..@@@.@@..@@@..@@@..@.@.@..@@.@@..@@.@...@.@.@@@@@@.@@@@.@..@.@@@@.@.@@.@@...@@@.@@@@..
.@...@@@@.@@.@@@...@@.@...@@@.@@.@@.@@@.@.@@@.@@@@@@@@..@@.@@..@.@@@@..@@.@@@..@.@@.@.@.@@.@@.@@@@@@@@@.@@@@@..@@@@@@@@...@..@..@@@@@@..@
...@@@@...@.@.@.@@@@@..@.@@.@@.@@@@@.@@@@..@@.@...@@@@@..@@@@@..@@...@..@@@..@@@@.@.@.@@@@@@@.@@@@@@.@@@@........@@.@@@@.@@@@@@@@.@@@@@@@
@@@@@@.@@.@..@@@@@.@@@@.@@..@@@@@.@@@@@@.@@.@.@@..@@@@@.@@@@.@@.@@@.@@.@.@@@...@@...@..@@@.@@@@@@.@@@@.@@.@..@@@@@@.@@..@.@@....@.@....@@
@.@.....@@@@@@@@.@@.@@..@@@...@..@@.........@@.@@@@@@@@.@@@@..@.@@.@@@@...@@..@@@@...@@.@..@@@@@@@@@@.@@@.@@@@.@.@@.@@@..@.@@@.@.@...@@.@
@.@.@..@..@.@@..@@@@.@.@.@...@@@@@.@.@.@@@@.@@@.@@....@.@@.@@@.@@.@@@.@@.@..@@@@@@@.@@...@@@@..@.@@@.@@@@@@@@.@@@@.@..@.@.........@@@...@
@@@@@.@@@@@@@@@..@@@.@.@@@@@.@@@@..@@@.@@@@@.@@@@@@.@@@.@@@.@.@@@.@.@.@@...@@@.@@@@.@...@@@.@@@..@@.@@.@@@@...@.@.@@.@.@@.@.@@@...@@@@@@@
@..@.@@@..@@@@@@@@.@@@@@@.@@.@.@@@@@@.....@@..@@.@@..@.@.@@@..@@@@.@@@@@.@@@@@.@...@@..@@@@.@@@@@.@@@@@@...@@@@@@@@@@@@@.@@@.@@@@.@@..@@@
@@.@..@@@....@@@@.@.@@..@@..@.....@@.@.@@.@..@@@@.@..@@.@.@@...@@@@.@@@@@@...@..@@.@@@@@@.@@@@@@@@.@.@.@....@@.@@..@@@.@..@@@.@@@@@@.@@@@
@@@@@@..@@@@@...@@@.@@@@...@.@@....@.@@.....@@@@@@..@@@@@@@@@@@.@.@.@@@@..@..@@@..@.@.@@@@.@@@@@..@....@@@.@..@.@@@@@@@@@@@@.@..@.@..@@.@
@@.@@.@@@.@@.@.@@@@@@@@@@@.....@.@@..@@..@@@@@.@@..@@@@@@.@.@@.@@.@@..@@@@@.....@@@@@@@.@@.@@@@@@@@@.@.@.@@..@@@@.@@..@....@@@@.@@@..@@@@
@@@.@@..@@.@.@@@@@@.@.@@.@.@@@@@..@@.@@@@@@.@@..@@...@....@@..@.@@.@.@.@@@.@@@@..@.@@@@@@@@@..@.@@@.@.@...@@.@@@@@..@..@@@@@@@@.@.@..@@.@
@.@@@.@@..@@@@@@.@..@@@@..@.@@...@@.@..@@.@.@.@@.@@@@@@@.@@.@.@@...@@@@@@.@@.@@@@@@@@@@@@@...@@..@@@@@@@@.@@.@.@@@@@@@@@.@@@..@@@.@..@@.@
..@.@@.@..@@@.....@@@@.@@.@@@@@@@@.@..@@@@.@.@.....@@.@@..@@@@..@@.@.@@.@.@.@@@.@@@@@.@@.@@@@@@@@@@@@.@@@.@@.@@@..@@.@@..@..@.@.@..@@@@@.
.@@@.@@.@@@@.@@@@.@@..@@@@.@.@..@.@@@.@.@@@@@@@@..@@@@.@.@.@@@@.@@@@.@@...@@@@@@@@.@@.@.@@.@@@@.@@@@.@@..@.@@..@...@@@@..@@@@@@@@@.@@@@@@
@.@.@.@@@@.@.@.@@@.@@@.@@....@.@@@.@@@@@@@@@..@..@@@@....@...@@@@.@@@@..@@...@@@@@@@@@@@@@@....@.@@.@@.@@@@@@@...@.@.@@@.@@@@@@@@.@@.@.@@
@@@...@..@@@.@@...@..@@@@@@@@@.@@@@@@@.@@.@@@.@.@@@@....@@@..@.@@.@@@@@@@.@@@@..@.@@@..@.@@..@@@@@@@@@.....@.@...@@@@.@@.@@@@@@@@@@.@@@@@
..@.@@@@..@.@@.@@@.@.@@@@@.@@@@@@..@@@.@@.@.@.@.@..@@@@@@@@@@.@.@@@@.@@@.@@@@.@@@.@..@@......@@@@@@@@@@@@@@@.@@@.....@@@..@@@@@.@@.@.@@@@
@@.@@@...@....@...@..@@@@...@.@@@@@@@..@....@.@@@@.@.@.@@@@...@@.@@@@.@.@@@@.@.@@@@@..@@@@@.@@.@.@@@@@.@.@@@@@@@@@@@@@@.@....@.@@@.@@..@.
@@@.@@.@@.@@@@@@@.....@@@@.@@@..@@.@....@@.@@@@.@@@@@..@..@......@@@@@@@@.....@.@...@@@.@@@@@..@@@@...@@.@@@.@@@.@@@@.....@@.@@@@@.@..@.@
.@@.@..@@@@@@@@@@.@@@@@@.@@.@@@@@..@@@@.@@@@@@...@@.@@.@.@@...@@.@@@@@@@@@.@.@@@@.@@@@@@.@@@@.@.@@@@@.@@@.@.@.@.@@.@@@@@@@@.@@.@@.@@.@.@@
.....@.@@...@@@.@.@@.@..@.@@@...@.@@@@@@@.@@.@@@@@..@.@@@@@..@@@@@@..@@@@..@..@.@.@..@@@...@@@@@.@.@@@.@@.@@..@@@@@.@@@@@.@@@@@@@@.@..@.@
.@.@@.@.@@.@....@@@@..@@@@.@@..@.@..@@@.@@@...@@@.@@@..@.@@@@...@..@.@@.@@@@@..@@@.@@.@@..@...@.@@.@@@.@@@@...@@@@.@@@@..@@@@@@@@@@..@@.@
.@@.@.......@@@@...@.@@@..@@.@..@@@.@@@.@.@...@@..@@@@.@.@@@.@.@.@@@@@@..@@@@..@@@@.@.@@.@@@..@@..@@@@@@@@@@@@.@@@@..@@.@.@@@.@.@..@@..@.
.@@@@.@@@@@.@.@@@..@..@.@.@@.@.@@@.@@.@@@@..@.@@@@.@@@@.@.@.@@@@.@..@.@@@@.@@@.@@.@.@@@@.@@@@..@@@@@...@@@..@@@@.@@.@...@@@@@.@@@@@@.@@@.
@@@.@.@.@@@@@.@@@.@@@@@@@..@@@..@@@.@@.@.@.....@@@@@@@..@@@@.@.@.@@@.@@@@@@.@..@...@@@@@@..@...@@@@@@.@@@...@.@@..@@@..@@@.@@@@.@@.@@@@@.
@.@...@@@.@...@@@.@.@@@..@.......@.@@@@@.@@.@.@@@..@@.@@@@..@.@@@@@@@@@@@@@.@@.@@@...@@@..@@@@...@.@.@@@..@@@@...@@@@@..@@.@@.@@@@@.@@@.@
.@.@...@..@.@@@@@.@@@@@@@@.@.@@..@@....@..@@.@@..@.@@....@@@@@@@.@@@@...@@@@@@@@.@@.@..@@@@.@@@@@.@@.@..@@@@.@@...@@@@@.@@@@@@@@@@.@@.@@@
.@.@......@@@..@@@.@@.@@@@.@@@@@.@...@.@@@.@@@@@@@@@@@...@@@@.@@@@@.@@@@@.@..@@@.@.@@.@@@@.@@.@.@@@.@@.@.@@.@.@.@@.@.@@.@@.....@.@@@@..@@
@@@..@@.@@.@@..@@.....@.@....@.@@@.@@.@@@.@..@@.@@@.@@.@@@@.@.@.@@...@.@@@..@..@@.@@@@@@@@.@@@@.@@@.@@@@@..@@@.@@@...@@@..@@.@@@...@..@@@
@.@.....@@.@@.@.@@@.@@@.@.@@.@@@@......@@@@@.@.@.@@.@..@.@@@..@@@..@@@@..@@..@@@@@@.@@@.@..@@@.@@@@@@.@.@..@@@@..@@@@.@@@@@@..@@@@@@@@.@.
@@@@@@@.@.@@@@@..@.@@@.@@@.@@.@@@@@@.@@@@.@@@@@@@@@@.@@@.@@@@.@.@....@@@.@.@@@@@@@@@..@@@.@@@.@.@@@@@@@.@@@@@..@@@@@@.@.@.@@@@@@@.@..@@@.
.@@@@..@.@@@.@@@@@..@@@..@@@@.@.@.@@.@.@@@.@..@@@@@.@@.@@@.@@@@@@.@@@..@.@@.@@....@.@@@@@@@@.@@@@...@@@@@@.@..@@@@@.@.@@.@@@@..@@@@@..@@@
@@.@..@@....@@.@@.@@@.@..@@@..@@@@.@.@.@..@@@.@@@@@.@@.@@@@@.@..@@.@@@@@...@@@@@@@@@@.@@@@@@@.@@...@..@@.@@.@@@@@.@@.@@@@@.@......@@.@.@@
@@@@.@@@@@.@@@.@.@@@@@@@@@@@@@@@..@@.....@@..@@@@@.@@@@..@@@@@@@.@...@@@.@..@@@@@.@@@..@@..@..@@.@@.@@@.@@@@@@@.@..@@.@.@....@@@@@.@@.@.@
@@..@@@@.@@.@.@@...@..@@@@@.@@..@.@...@@.@@@@@.@@.@..@@@.@@@...@..@..@@...@@@@..@@@@@..@@@..@@.@@@@.@..@@@@.@@@...@@@..@@@@.@@.@.@@..@@@@
@.@@@@..@@.@@........@@@@@@.@@@@.@@@@..@@.@..@@@@@..@@...@...@..@.@@@..@.@@@..@...@.@@@.@.@.@@@@@.@.@@@@....@@@@..@..@@..@.@@@@@@@@@@@@@.
@@@.@.@@@@@@@@.@..@@..@..@@@@@@@..@@.@@@.@...@@...@@@@@@@@.@..@.@@@@@..@@@@.@.@.@@@@.@@...@@@@@@.@.@@@.@.@@@@.@@@@..@....@@.@@@@..@@@@.@.
@@@@@..@@@@.@@@...@@@@@..@@.@@@@@@@...@@.@..@@@..@@.@.@@@@@@..@.@@@@@.@@@.@@@@..@@.@@@.@..@@@...@@@@.@.@..@..@@@@..@.@@@@@@@@.@@@.@@@..@@
..@.@.@@.@@.@@@.@@.@.@@@.@@.@@@@@@@.@@.@@@.@@@@@@@@.@@@.@..@@@..@.@@..@.@@@@..@..@...@@@.@.....@@@.@@...@@..@@..@..@@@@@.....@@@@@@@@@@@@
@@@@@.@...@.@.@@@.@@@@@@@@.@@@@@..@..@..@.@....@.@.@@@@@@..@@.@@.@.@@.@@.@@@@@@..@.@@@@..@@.@@@@.@.@@@@.@..@@@@.@...@.@.@@.@@.@@@@.@@@.@@
@..@@@.@@...@@@@@.@@@.@@@.@@@@@@@@@@...@.@@@@...@..@..@.@.@@@.@.@.@@.@.@@@@@.@@@@@@@@@@@..@@.@@.@@.@@..@@@@@.@.@@@@@@.@@.@....@@.@@.@@@@@
.@@@@@@@.@@@.@@@.@@@@@@@.@.@@@@@@@@..@@....@@.@.@@..@@.@@@@@@@.@@@..@.@@@@@@@@.@@@.@...@@.@@..@.@@...@@@@.@.@.....@@@@@@@@@@@@@@@@...@@..
@@@@.@...@.@.@.@@@@.@@@.@...@@@.@@@@@.@@@@@@@@@...@@@..@..@@@.@@@@@..@.@@@@@@@.@..@.@@@@@..@@.@.@@@.@.@..@@@@@@@.@....@@@.@.@.@@....@@@..
@@@@.@@.@@@@@.@@@@@@@@@@@@@@@.@@.@@@@@@.@@@@.@.@.@@@..@@...@@@@@....@.@@.@@@@..@@.@@@...@@@@.@.@@.@@@@@.@@@@....@..@@@..@..@@@@..@@@@...@
@..@@@.@@..@@.....@@@.@.@@@@@.@.@@.@.@.@.@@@@@@@.@@@.@.@@.@@..@@@..@@@@@@.@..@@.@@.@@@@.@@@@@@@.@@@@@@...@@@..@.@@@@@.@@@.@@@.@@.@@.@@@..
...@@@.@@@@@@@@..@.@@..@@.@@...@@@@@@.@@..@..@@@@@@.@.@@@@@..@.@..@@@@@@@.@.@@@@@@@@@@@@@.@.@...@@@@@.@@.@@@@..@@@@@@@...@..@.@@@@@.@..@@
@.@.@@....@@@.@.@@..@@.@@@.@.@.@.@@@@.@@@..@..@.@..@@.@.@@@@@.@@.@.@@@@..@..@@@@@@@@@@@..@@@.@@@@.@.@@.@.@@..@@@......@@@@.@..@.@@@@@.@..
@@@@@@@@.@.@@@...@@@@@@.@@@.@@@@@@@.@@@@@@@@.@.@..@@.@@@@@@@.@@@@@.@@@@@@@..@@@@.@.@@.@.....@@@.@@@@@@@.@@.@@@@..@@@@@..@.@.@.@@.@..@@@.@
.@@..@.@..@@@.....@@@@@.@@@.@@@@@@.@.@@@.@@@@@.@@@.@..@.@@@..@..@@..@@@@..@@@...@@@@@@@@.@@@@@@@@@@..@.@@@..@@@.@@@..@@.@.@@@@.@@.@@.@.@.
.@..@..@.@@.@.@@.@.@@..@@.@@@@@@..@.@@@.@..@.@..@@.@@@..@.@@@@@@@.@@@@.@@.@@@@@.@@@.@@@@@@@@..@.@@..@.@@@@@@.@@@.@..@@@@.@@.@@@@@@..@@.@.
.@.@..@..@@@.@..@.@@.@.@.@@@@@@.@..@@@@..@..@.@@@..@...@....@@@...@@@@@.@.@@.@@.@@.@.@@.@@@@@@@..@@@@@.@@@..@@@@@@@..@.@@..@@.@@@.@@@.@.@
@@..@...@@@@@@..@.@@....@.@.@@@@@@@@....@@@@@@..@@.@@@..@..@@@@@...@@@@..@@.@@@@.@@@.@@@@@.@...@@@@@@@@.@@@.@@@@@.@@@@..@@.@.@.@.@.@.@.@@
.@@@.@@..@@..@@@.@..@@@@.@@@.@..@@@@.@@@@@@@.@@@@@.@@@@..@.@.@@@@.@@@..@@@..@@...@@@@@@.@@@.......@@...@..@.@@@..@.@@@@@..@..@...@.@@..@@
@@@.@...@@@.@@@.@...@.@@.@@.@.....@..@...@.@.@.@...@..@.@.@@@.@@@..@.@@@@.@@....@@@@.@@@.@@@@@@@..@@.@@@@@@@@@@@@@@@.@@@@..@@@....@@.@..@
@...@.@@.@.@.@@...@@@.@...@@@@@..@@@...@@@.@@.@.@@.@.@@..@.@@@@@.@@@@@.@@@@@@.@@@.@@.@.@@@.....@.@.@..@.@.@...@.@@@...@@...@...@...@@@@@.
@@@.@@@.@@..@@.@.@@...@@@....@.@@.@..@@@.@.@@@@..@@@.@....@@@@@@@@.@@.@@@@@..@@@.@.@@@..@..@..@@.@@@@@.@@.@@@.@.@..@...@@.@@.@..@.@.@@@@.
@@.@@....@@@@@.@@.@@.@.@@@@@.@@@@@.@@@.@@@.@.@@@.@@.@.@@@.@@@@..@@@@@@@@..@@...@@....@@@@.@@.@@.@@.@.@.@@@@..@@@..@@.@@.@.@@..@@@@@.@..@@
.@@@@@@.@..@.@@@@.@@...@@@.@@.@@@@@.@..@.@.....@.....@.@@@@..@@..@@.@@@@@@@...@@@@@@@....@.@@@@@@@.@@.@@....@.@@.@@.@.@@@..@.@@.@..@@@@@@
@@.@@@@.@@.@.@.@.@@@@@@@@@@.@@.@@.@@@@.@.@@....@@.@@..@@@@@@.@@@..@@@@...@@@@.@@@@@@@@@..@@@@..@@@@...@@....@.@@...@@.@@@@@@..@..@..@@@.@
..@@@@.@@@@.@@@@@@@@@@@@@@@@@.@@@@.@@...@@.@@@@@@..@@.@@@.@@.@@@.@.@..@@@@@..@.@@.@@@.@@@@@.@.@.@...@@@..@....@@...@.@@@.@.@@@@@@...@@@@@
@.@@.@@@@@@..@...@@.@@@.@@@@@@@@@...@..@.@@@...@.@@..@@@.@..@@@@@.....@@.@@...@@.@.@@@@.@..@.@..@.@@@.@..@.@..@@@@@@@@@@..@.@@.@...@@@.@.
@@.@..@.@..@@.@@...@@.@@.@@@..@@@@.@@.@@@@@@@@@@@@@.......@@@.@@@@@@.@@...@@..@.@@@@@@..@@@@@@...@@@..@@@.@@.@@@@.@..@..@..@.@@@@@.@@@@.@
@@@.@@.@.@@@..@@@@.....@@@@@@.@..@@@.@.@@@@@...@....@@@@..@...@@@@@@@@@@@..@...@@@@@..@@@@@...@.@@@.@...@.@..@@@@.@...@@.@@.@.@...@.@@@@@
@..@@@@@.@@.@@..@..@@@....@@..@..@@.@@@.@.@....@@@@@.@@@@..@@@.@.@@@@@@.@@.@.@@@@@.@@.@.@@@.@...@@@@@@@@@@@@@@@@@@@...@.@..@@@@..@@.@...@
...@@@@.@@@@@@@@@.@..@@@@..@@.@....@@@.@.@@..@..@@.@.@@....@@.@@@@.@@....@@@.@@@.@@..@..@@@@@@@....@@@@.@@@@@@.@...@@.@@@@.@@@..@@@@..@.@
..@.@@@@@..@..@@.@.@...@@@@.@.@..@@@.@@@@..@@.@@.@@@@@@...@@@@@@.@@@@@@@@.@@@.@@@@@.@.@@.@@@@..@@@@@@@@...@..@.@@@..@@@@@.......@...@@@@@
@.@@.@@@.....@@@@@@@@@@@@@@@.@.@...@.@@..@@.@@.@.@.@.@@..@@@.@...@@..@...@.@.@...@@@.@@@@@@.@@...@@..@.@@.@..@.@@.@..@@.@..@..@@@.@.@@@@.
@.@@@.@..@.@..@@@@@@@@@@.@@@@.@@@@@.@.@.@@@@@@..@@@@@@@.@@@...@@...@.@@@@@@@@...@@..@...@@@@@@.@@@.@@@@@@@@.@@.@@.@.@@@@@@@.@@@@@@.@.@@.@
@@..@@@.@..@@@@..@.@@.@@@@@.@@.@@.@@@@@@.@@@@@@.@@@@@.@@@@.@@@....@@@@.@@..@.@.@@.@.@...@@@@@@.@..@@@@@@@@.@@@.@@.@@@@@@..@..@@..@.@@.@@@
@.@@@@.@@@@..@..@@..@@@...@@@@@@@...@..@@@@....@.@@.@..@@@@.@@.@@..@@@.@@@@@.@@.@@@@@@@.@..@..@.@@@@.@@@@..@..@..@.@@@@@@.@@@@@@@..@@@.@@
..@@@..@@.@@@@@@@.@.@.@.@@@@.@@@@@.@@@...@.@@..@@@..@@@@@@@@@..@@@@......@@@@.@@@..@@.@@@@@.@@@.@@@@.@.@@@.@@.@.@@@@@.@.@@@.@@@.@.@@@..@@
@@.@@.@.@.@@..@@@@@..@....@.@@@@@.@.@@.@...@@..@@..@@@.@.@..@@@@@@..@@.@@..@@@.@..@@@@@@@@@@@@@..@@..@@..@@@@@..@.@@.@@@.@@@@.@@@@@@@@.@@
@@.@@..@@@@@...@..@@@.@..@@@@..@@.@@@@.@@.@@..@@@@@...@...@@@..@@..@@@.@...@.@@@.@@..@.@...@@..@@..@@@@.@.@.@@@..@@@@@@@@@@@..@@@@@..@@@@
@@...@.@.@@@..@..@..@.@.@@@@.@..@@@.@@@.@@@.@@.@@@@@@..@@.@.@@@..@.@.@......@@.....@@@...@@.@@@@@...@@@@...@@@@@@@@@...@@..@@@.@.@@@@.@@@
@...@.@@@..@.@@@@.@@@..@@@@@..@@@@.@.@@@@@.@..@@@@@@@.@.@@@.@...@@@@..@@@@@@.@@@@@@@@@@.@@.@@@.@.@@@...@@.@.@.@.@@.@.@@@.@.@@@.@@@..@@.@.
.@@@@@..@@.@@@@@@@.@.@@...@@@.@@@...@@.@@@@@@@.@@@@@.@@@@@@@@@@@@@@@@.@.@@@@@...@@.@.@...@@.@@@@@.@@@.@.@...@@@.@@.@@..@@@@..@@.@@@.@@@.@
@@@.@@..@@....@@@.@@@@@.@.@.@...@@@..@@.@@@@..@@@@.@.@.....@@@@@@@@@@.@.@@.@.@@.@@@.@@.@@@.@.@.@@.@@@@@.@@@.@@@@@.@.@@..@.@.@@@@@@@@.@.@@
.@@@@.@@@@@...@@@@.@@..@.@.@@.@.@..@.@@.@......@.@...@@@@@@...@...@@@@@@@..@..@@.@@@...@.@@....@@...@@@..@@@@@@@.@.@@@@@@@@@@.@.@@@@@.@@@
.@.@@@@@@@@@.@@@@.@@.@...@@@...@.@@.@@@..@.@.@.@.@@.@.@@@@@@@@....@..@.@.......@@.@@..@@@.@..@@@@@@..@.@@@..@.@@@@@@@..@.@@@@@@@@@@.@.@.@
@@@@@@@@.@...@@@.@...@...@@..@@.@@.@@.@.@.@...@@@..@..@..@@@@@@@.@@.@@@@@@@@.....@@@@@@@@.@@@@@@@@..@@.@@@@@@@@@@@.@..@....@@..@@@@@@@@@@
@.@@@@@@....@..@@..@@.@@@..@..@@@.@@@..@@@@.@.@@@@..@@@@@@@@@@.@@@.@@.@@@....@@.@@@..@@@@@@.@....@@...@.@@.@@.@..@.@@@@@@@@@@@@.@@@@..@@@
@@@@.@@@@@..@.@.@....@.@@.@@@.@@...@.@.@@.@.@@.@.@.@@@..@@@@@@@.@.@..@.@@@@@@.@@.@.@.........@.@@@..@..@@@@@@@..@.@@@@.@@@@..@@@@@.@@.@@@
@@@@.@@@.@@@@..@@..@..@@@..@.@@@@.@@@.@@..@@@..@@.@@@@@@@@@@@.@.@@.@...@.@.@@.@@@.@@@@@.@@@..@.@@@....@@.@@@@@....@@.@@@.@@.@..@.@@.@@@@.
.@@...@.@.@@.@@@.@.@.@@@@@.@.@@@@@@@..@@@@.@.@@@@@@@@.@.@@@.@..@@@.@@@.@@@@.@...@.@@.@..@.@..@@.@@..@@.@.@.@..@@@.@@@@@.@@@@@.@@@@...@@@@
@@@@@@@@.@.@....@@@@@@@@@@@@.@@@@@@@@..@..@@.@@@...@.@@..@.@@@@@...@@@@.@@@@@@.@@@@.@@@..@.@.@@@@...@@@.@@@@.@.@@@@.@.@@@.@.@.@@@@@.@.@@.
.@.@@@@@.@@@@@@@@@..@@@@...@.@@@@@@..@@@@@@@@@.@@@@@@..@.@.@@.@.@@@@@.@..@.@@....@.@@..@..@@.@@@.@@@@.@.@@.@.@..@.@.@@@@@.@@@.@@.@.@@.@.@
.@@@@.@@.@@.@.@.@.@@@@@..@@.@@@@@@..@..@@.@.@@@@.@@.@.@.@@...@@.@@@@@.@...@...@...@@@@..@.@@@@@@@@.@@.@@@@@.@.@@@.@@..@.@@.@@.@.@@@@.@@@.
@@..@@.@@.@..@@.@@@..@@@@.@.@@@@.@@@.@@@@.@@@.@@@.@@@..@@...@@@@..@..@@@@@@.@@@.@..@..@@.@@@.@@@..@..@.@@@@..@.@@@@.@@@.@@..@@.@.@..@..@.
@@.@@.@...@@..@@@@@@..@@@@@..@@@@.@@@@@@@.@@.@.@@@...@@@@@@@.@@@@.@@@.@...@@@.@@@@@@@@@@@.@.@@..@.@@@@@..@@@@@@@@.@@@@@@@.@..@@.@.@@@@..@
@@@@@@@@@.@@@..@.@@.@@...@.@@@..@.@.@@@@...@@....@@@@@@@@@@@@.@@@.@@@.@@@.@@@.@.@@.@@@.@.@@@@@@@.@.@@..@..@@@.@@.@.@.@..@@@@@.@@@.@@.@@@.
@.@@@@.@@@@@@@..@.@@...@@.@@.@...@@....@.@..@@@...@.@@.@@.@@@.@.@@@.@@@..@.@@....@@@.@.@@@@@@@@@@@...@@@.@.@@@..@@.@@@@@@.@@@.@.@@@@.@@..
@.@@@@..@.@@...@@@.@@@..@.@.@@@.@@..@@.@@@@.@.@@.@...@@@@.@.@@@..@@.@@@@@@@..@.@@@@..@@@@.@@.@@.@@.@@.@@@@..@@.@@@.@@@@@@@....@.@@.@@@@@@
.@@@@...@.@.@@@.@@.@@@@@.@..@@.@@@@.....@@.@@..@.@@.@.@.@..@.@.@.@.@.@@...@.....@@@@@@.@@@@.@.@@@.@@@@@@..@@@@.@.@@..@..@@@@@@.@@@.@.@@@@
.@@@@.@@.@.@@......@.@.@@@@....@.@@.@.@.@@@@@@..@@@.@@....@@@@@.@@@.@@@@.@@@.@@@@.@@@@@@..@@..@@.@..@@.@.....@@@@@@@@.@@.@@@@@@@..@@@@@.@
@.@@..@@..@@....@@@@.@@@@@@@.@..@@@@@@...@@.@@@@@@@..@@.@.@.@@@.@@.@@@@@.@@...@@.@@@@..@...@..@@.@..@@..@@@.@@@@@.@@@@@@@@@.@@.@@@@@@@@.@
@@@.@@@@...@@.@@@..@@.@@@@@@@@@.@@@.@@@@@@@.@@@@@..@.@.@.@@@@@@..@@..@@.@.@@.@@..@.@@@@..@@@@@..@@@.@@@@@@.@@...@@..@..@@@...@@@.@@@@.@@@
.@@@@.@.@@....@.....@@.@@@@@@@@@@.@@.@@@@@@@@.@@@@.@@..@@@...@@@.@@@@@@@.@@..@..@@@.@@.@.@....@@@.@....@.@@@.@@@.@@@@.@@.@@@@.@.@.@@@.@@@
@@.@.@.@@.@@@@.@@..@.@.@.@..@@.@@@@...@@......@.@..@.@@.@@.@@@@.@@@@.@@@@..@.@@.@@@@@@....@.@@@@@.@@..@...@@.@@....@.@@.@@@.@@.@@.@@@@@@@
@.@..@@.@..@.@.@@@@@@.@.@.@.@@@.@@@@..@@@...@@@..@@@....@.@@.@@@@@@@@@@@...@@@.@@@..@@.@@@@@....@@@.@@.@@.@@@..@@@@@@@.@@@@..@.@@..@@@..@
.@@@@@...@..@@@.@...@@@@@@@@@.@.@@.@@@.@@@@@.@@.@.@@@@@@.@..@@.@@..@@@@@@....@.@@@@@@@@@@@.@@@@@@@...@@.@@@.@@@.@.@@@@@@.@.@..@.@@@@@.@.@
@@.@.@.@.@.@@....@@@.@@@@...@.@@.@@@@@@.@@@@@@.@@@.@..@@@@@@@@@@.@@@@@.@@@@@@.@@.@....@.@@...@..@@..@..@@@@.@@.@@@@.@...@.@.@@@@@.@..@@.@
...@@@@@.@@@@.@@.@@@@.@@.@@.@@.@@@.@.@@@@@...@@@@...@@@..@.@.@.@@@@@@@@.@@@@@@@@.@@@..@..@@..@.@.@...@..@@@.@@..@.@...@.@@@@@.@.@@..@.@@@
.@@@@@.@@@@@.@@@@.@.@@@@@@@..@@@@@@@@@@.@@@.@..@@..@.@.@@@@.@@.@.@@@.@@@.@@@@@@.@@@@.@....@@.@@@@@@@.@@@@@...@@@@.@@@@@@@@@@@@.@@.@@@.@@.
@.@@@...@..@..@@.@@.@@@...@@@@@@@@@..@@...@@..@@.@@@.@@.@@@@.@@...@@@@..@@.@@@@@......@@.@@@@@..@.@@.@@..@..@...@@...@@@.@..@@.@.@@@@.@@@
.@@.@@.@@@@@@@@@@.@@@.@.@@..@@@@@.@@@.@.@.@@.@@.@.@@@.@@@@@@@@.@@..@@...@..@@.@@.@.@@@@@@@@.@@.@.@@@.@.@@@@.@@..@@@@.@...@.@.@@..@@@..@..
@@...@@.@@@@.@@@.@.@.@..@@@@@.@@@@@..@@..@@@..@..@@.@@.@@.@.@@@@@@@.@.@.@@...@@.@...@@@...@@.@@@@@.@@..@@@@@@@.@@@@.@@@.@@@@@@..@@@@@@...
@.@...@@..@@@.@.@@@@@@@@..@@@@@@@@.@@@@..@@@.@@..@.@@@@@@.@@@@@@@@.@@@.@@@@@@..@@..@.@.@.@@@.@@@@@@.@...@@@.@@.@@@.@@@.@@@.@@@@.@@...@@@@
@..@.@@@..@@.@@@@@@.@@@.@@@...@@@@..@..@@@.@.@@@...@@@@@.@@@@@@@@.@@@@.@@@@.@..@@@@....@@.@@.@@.@...@@@.@@@...@.@.@@@@@@@@..@..@@@@@@@@@.
..@@.@@..@@.@@..@@@@.@.@.@@@@..@@@@@.@...@@@@.@@...@@.@@@@@@.@@..@.@@@..@..@.@@@.@.@@@...@@@@@@@@.@@@..@@.....@@.@@.@@@..@@...@@..@@....@
.@@@@.@@@..@@@.@@@......@@@..@@@@@@@@@@.....@@@.@@@@@@.@@.@@@..@@@@@@@@@.@..@.@.@..@@@.@@@.@...@.@.@.@.@@.@@@.@@@@@@@@@..@@@@..@@@@@@@@.@
@@.@@@....@.@.@@@@@@@.@@@.@@@@.@...@@.@.@@@@@.@.@.@.@.@@.@@..@@@@.@@@@@@@..@@@.@@.@@@@.@...@@.@.@@.@.@@.@@@.@@@@@@@.@@@.@..@@@@@@.....@.@
.@.@@@@.@@.@@.@.@.@@@@@@.@@@.@@.@..@@.@@@@..@@@.@@@@@.@@.@.@@.@@@@@@@@..@.@@@@@@@@@@.@.@@@@...@@.@@@@@.@@.@@@.@@.@@.@@@@.@@@@..@@...@@@@.`;

findAcessRolls2(input);